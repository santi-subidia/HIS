extends ../layout

block content
  .container.mt-4
    .row
      .col-md-12
        .d-flex.justify-content-between.align-items-center.mb-3
          h2 
            i.bi.bi-heart-pulse.text-info.me-2
            | Gestión de Enfermeros
          .d-flex.gap-2
            a(href='/enfermeros/create')
              button.btn.btn-success
                i.bi.bi-plus-circle.me-1
                | Registrar Enfermero
            a(href='/dashboard')
              button.btn.btn-secondary
                i.bi.bi-arrow-left.me-1
                | Dashboard

    if success
      .alert.alert-success.alert-dismissible.fade.show(role='alert')
        i.bi.bi-check-circle.me-2
        = success
        button.btn-close(type='button' data-bs-dismiss='alert')

    // Filtros de búsqueda
    .card.mb-4.shadow-sm
      .card-header.bg-light
        h5.mb-0
          i.bi.bi-funnel.me-2
          | Filtros de Búsqueda
      .card-body
        form(method='GET' action='/enfermeros')
          .row
            .col-md-5.mb-3
              label.form-label(for='nombre') Nombre o Apellido
              input.form-control#nombre(type='text' name='nombre' value=filters.nombre || '' placeholder='Buscar por nombre')
            
            .col-md-4.mb-3
              label.form-label(for='dni') DNI
              input.form-control#dni(type='text' name='dni' value=filters.dni || '' placeholder='DNI' pattern='[0-9]*')
            
            .col-md-3.mb-3.d-flex.align-items-end
              button.btn.btn-primary.w-100(type='submit')
                i.bi.bi-search.me-1
                | Buscar

    // Tabla de enfermeros
    .card.shadow-sm
      .card-header.bg-info.text-white
        h5.mb-0
          i.bi.bi-list-ul.me-2
          | Listado de Enfermeros (#{enfermeros.length})
      .card-body
        if enfermeros && enfermeros.length > 0
          .table-responsive
            table.table.table-hover.table-striped
              thead.table-light
                tr
                  th.text-center #
                  th Nombre Completo
                  th.text-center DNI
                  th.text-center Teléfono
                  th.text-center Acciones
              tbody
                each enfermero, index in enfermeros
                  tr
                    td.text-center= index + 1
                    td
                      i.bi.bi-person-fill.text-info.me-2
                      strong= `${enfermero.persona.apellido}, ${enfermero.persona.nombre}`
                    td.text-center
                      span.badge.bg-secondary= enfermero.persona.DNI
                    td.text-center= enfermero.persona.telefono || '-'
                    td.text-center
                      form(method='POST' action=`/enfermeros/dar-baja/${enfermero.id}` style='display:inline' onsubmit="return confirm('¿Está seguro de dar de baja a este enfermero?')")
                        button.btn.btn-sm.btn-danger(type='submit' title='Dar de baja')
                          i.bi.bi-trash.me-1
                          | Dar de Baja
        else
          .alert.alert-info.text-center.mb-0
            i.bi.bi-info-circle.me-2
            | No hay enfermeros registrados
            if filters.nombre || filters.dni
              |  con los filtros aplicados
            | .
