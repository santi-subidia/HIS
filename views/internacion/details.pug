extends ../layout

block content
  .row
    .col-lg-12.mb-4
      h3.text-primary.mb-4
        i.fas.fa-bed.me-2
        | Detalles de la Internación

  if internacion
    // Información del Paciente
    .card.mt-4.shadow
      .card-header.bg-primary.text-white
        h5.mb-0
          i.fas.fa-user.me-2
          | Información del Paciente
      .card-body
        .row.mb-3
          .col-md-6
            p.mb-2
              strong.text-muted DNI:
              span.ms-2= internacion.PacienteSeguro && internacion.PacienteSeguro.paciente ? internacion.PacienteSeguro.paciente.persona.DNI : '-'
          .col-md-6
            p.mb-2
              strong.text-muted Nombre Completo:
              span.ms-2= internacion.PacienteSeguro && internacion.PacienteSeguro.paciente ? internacion.PacienteSeguro.paciente.persona.nombre + ' ' + internacion.PacienteSeguro.paciente.persona.apellido : '-'
        .row.mb-3
          .col-md-6
            p.mb-2
              strong.text-muted Sexo:
              span.ms-2= internacion.PacienteSeguro && internacion.PacienteSeguro.paciente ? internacion.PacienteSeguro.paciente.sexo : '-'
          .col-md-6
            p.mb-2
              strong.text-muted Fecha de Nacimiento:
              span.ms-2= internacion.PacienteSeguro && internacion.PacienteSeguro.paciente && internacion.PacienteSeguro.paciente.fecha_nacimiento ? new Date(internacion.PacienteSeguro.paciente.fecha_nacimiento).toLocaleDateString('es-AR') : '-'
        .row
          .col-md-6
            p.mb-2
              strong.text-muted Seguro Médico:
              span.ms-2= internacion.PacienteSeguro && internacion.PacienteSeguro.seguro ? internacion.PacienteSeguro.seguro.nombre : '-'
          .col-md-6
            p.mb-2
              strong.text-muted Código de Afiliado:
              span.ms-2= internacion.PacienteSeguro ? internacion.PacienteSeguro.codigo_afiliado : '-'

    // Información de la Internación
    .card.mt-4.shadow
      .card-header.bg-info.text-white
        h5.mb-0
          i.fas.fa-hospital.me-2
          | Información de la Internación
      .card-body
        .row.mb-3
          .col-md-4
            p.mb-2
              strong.text-muted Fecha de Ingreso:
              span.ms-2= internacion.fecha_internacion ? new Date(internacion.fecha_internacion).toLocaleDateString('es-AR') + ' ' + new Date(internacion.fecha_internacion).toLocaleTimeString('es-AR') : '-'
          .col-md-4
            p.mb-2
              strong.text-muted Estado:
              if internacion.estado === 'activa'
                span.badge.bg-success.ms-2= internacion.estado
              else if internacion.estado === 'alta'
                span.badge.bg-secondary.ms-2= internacion.estado
              else
                span.badge.bg-warning.ms-2= internacion.estado
          .col-md-4
            p.mb-2
              strong.text-muted Prioridad:
              if internacion.prioridad === 'alta'
                span.badge.bg-danger.ms-2= internacion.prioridad || 'No especificada'
              else if internacion.prioridad === 'media'
                span.badge.bg-warning.ms-2= internacion.prioridad || 'No especificada'
              else if internacion.prioridad === 'baja'
                span.badge.bg-info.ms-2= internacion.prioridad || 'No especificada'
              else
                span.ms-2 No especificada
        .row.mb-3
          .col-md-12
            p.mb-2
              strong.text-muted Motivo:
              span.ms-2= internacion.Motivo ? internacion.Motivo.nombre : '-'
        .row
          .col-md-12
            p.mb-2
              strong.text-muted Detalle del Motivo:
              p.ms-2.mt-2= internacion.detalle_motivo || '-'

    // Ubicación
    .card.mt-4.shadow
      .card-header.bg-success.text-white
        h5.mb-0
          i.fas.fa-map-marker-alt.me-2
          | Ubicación
      .card-body
        .row.mb-3
          .col-md-3
            p.mb-2
              strong.text-muted Sector:
              span.ms-2= internacion.Cama && internacion.Cama.Habitacion && internacion.Cama.Habitacion.Ala && internacion.Cama.Habitacion.Ala.Sector ? internacion.Cama.Habitacion.Ala.Sector.nombre : '-'
          .col-md-3
            p.mb-2
              strong.text-muted Ala:
              span.ms-2= internacion.Cama && internacion.Cama.Habitacion && internacion.Cama.Habitacion.Ala ? internacion.Cama.Habitacion.Ala.ubicacion : '-'
          .col-md-3
            p.mb-2
              strong.text-muted Habitación:
              span.ms-2= internacion.Cama && internacion.Cama.Habitacion ? internacion.Cama.Habitacion.codigo : '-'
          .col-md-3
            p.mb-2
              strong.text-muted Cama:
              span.ms-2= internacion.Cama ? 'Cama ' + internacion.Cama.numero_cama : '-'

    // Contacto de Emergencia
    .card.mt-4.shadow
      .card-header.bg-danger.text-white
        h5.mb-0
          i.fas.fa-phone.me-2
          | Contacto de Emergencia
      .card-body
        .row.mb-3
          .col-md-6
            p.mb-2
              strong.text-muted Nombre:
              span.ms-2= internacion.ContactoEmergencia && internacion.ContactoEmergencia.persona ? internacion.ContactoEmergencia.persona.nombre + ' ' + internacion.ContactoEmergencia.persona.apellido : '-'
          .col-md-6
            p.mb-2
              strong.text-muted Parentesco:
              span.ms-2= internacion.ContactoEmergencia && internacion.ContactoEmergencia.Parentesco ? internacion.ContactoEmergencia.Parentesco.nombre : '-'
        .row
          .col-md-6
            p.mb-2
              strong.text-muted DNI:
              span.ms-2= internacion.ContactoEmergencia && internacion.ContactoEmergencia.persona ? internacion.ContactoEmergencia.persona.DNI : '-'
          .col-md-6
            p.mb-2
              strong.text-muted Teléfono:
              span.ms-2= internacion.ContactoEmergencia && internacion.ContactoEmergencia.persona ? internacion.ContactoEmergencia.persona.telefono : '-'

    // Acciones
    .card.mt-4.shadow.border-primary
      .card-header.bg-light
        h5.mb-0
          i.fas.fa-tasks.me-2
          | Acciones y Registros
      .card-body
        .row
          .col-md-4.mb-3
            .card.h-100.border-primary
              .card-body.text-center
                i.fas.fa-heartbeat.fa-3x.text-primary.mb-3
                h6.card-title Signos Vitales
                p.card-text.text-muted Registrar y consultar signos vitales del paciente
                a.btn.btn-primary.btn-sm(href=`/enfermeria/signos-vitales/registrar/${internacion.id}`)
                  i.fas.fa-plus.me-1
                  | Registrar
                a.btn.btn-outline-primary.btn-sm.ms-2(href=`/enfermeria/signos-vitales/${internacion.id}`)
                  i.fas.fa-list.me-1
                  | Ver Historial
          
          .col-md-4.mb-3
            .card.h-100.border-success
              .card-body.text-center
                i.fas.fa-clipboard-list.fa-3x.text-success.mb-3
                h6.card-title Plan de Cuidado
                p.card-text.text-muted Crear y gestionar planes de cuidado
                a.btn.btn-success.btn-sm(href=`/enfermeria/planes-cuidado/crear/${internacion.id}`)
                  i.fas.fa-plus.me-1
                  | Crear Plan
                a.btn.btn-outline-success.btn-sm.ms-2(href=`/enfermeria/planes-cuidado/${internacion.id}`)
                  i.fas.fa-list.me-1
                  | Ver Planes
          
          .col-md-4.mb-3
            .card.h-100.border-warning
              .card-body.text-center
                i.fas.fa-exchange-alt.fa-3x.text-warning.mb-3
                h6.card-title Gestión
                p.card-text.text-muted Dar de alta o trasladar paciente
                a.btn.btn-warning.btn-sm(href=`/internacion/alta/${internacion.id}`)
                  i.fas.fa-sign-out-alt.me-1
                  | Dar de Alta
                a.btn.btn-outline-warning.btn-sm.ms-2(href=`/internacion/traslado/${internacion.id}`)
                  i.fas.fa-ambulance.me-1
                  | Trasladar

    // Botón Volver
    .row.mt-4.mb-4
      .col-12
        a.btn.btn-secondary(href="/internacion")
          i.fas.fa-arrow-left.me-2
          | Volver a la Lista

  else
    .alert.alert-warning.mt-4 Internación no encontrada.
